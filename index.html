<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Narapoi</title>
<style>
/* ========== Reset & Base ========== */
* { box-sizing: border-box; margin:0; padding:0; font-family: 'Segoe UI', sans-serif; }
body { background: #0f172a; color:#fff; overflow-x:hidden; }

/* ========== Popup 18+ ========== */
#agePopup {
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.85); display:flex; justify-content:center; align-items:center;
  z-index:9999; opacity:0; pointer-events:none; transition:0.4s ease;
}
#agePopup.active { opacity:1; pointer-events:auto; }
#agePopup div {
  background:#1e293b; padding:30px; border-radius:12px; text-align:center;
  max-width:320px; width:90%;
}
#agePopup button {
  margin:10px; padding:10px 20px; border:none; border-radius:6px;
  cursor:pointer; font-weight:bold;
}
#agePopup button#yes { background:#2563eb; color:#fff; }
#agePopup button#no { background:#ef4444; color:#fff; }

/* ========== Header ========== */
header { display:flex; justify-content:space-between; align-items:center; padding:15px 20px; background:#0f172a; position:sticky; top:0; z-index:100; }
header .logo { font-size:1.8rem; font-weight:bold; background:linear-gradient(45deg,#f43f5e,#3b82f6,#10b981); -webkit-background-clip:text; -webkit-text-fill-color:transparent; animation:rainbow 3s linear infinite; }
@keyframes rainbow { 0%{background-position:0 0;}100%{background-position:300% 0;} }

header .actions { display:flex; align-items:center; gap:15px; }
header input { padding:8px 12px; border-radius:8px; border:none; background:#1e293b; color:#fff; width:200px; transition:0.3s; }
header input::placeholder { color:#94a3b8; }
header input:focus { outline:none; background:#2e3a5e; }

header .menu-icon { display:none; cursor:pointer; font-size:1.5rem; }

/* ========== Popular Carousel ========== */
#popular { margin:20px; overflow:hidden; position:relative; }
#popular .track { display:flex; gap:15px; transition:0.5s ease; }
#popular .item { min-width:200px; background:#1e293b; border-radius:10px; overflow:hidden; position:relative; cursor:pointer; flex-shrink:0; }
#popular .item img { width:100%; display:block; }
#popular .item .overlay {
  position:absolute; bottom:0; left:0; width:100%; background:rgba(0,0,0,0.6); color:#fff; padding:10px; opacity:0; transition:0.3s;
}
#popular .item:hover .overlay { opacity:1; }
#popular .nav { position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,0.5); border:none; color:#fff; padding:10px; cursor:pointer; border-radius:50%; }
#popular .nav.prev { left:10px; }
#popular .nav.next { right:10px; }

/* ========== Video Grid ========== */
#videos { display:grid; gap:15px; padding:0 20px; margin-bottom:30px; }
@media (min-width:768px){ #videos { grid-template-columns:repeat(2,1fr); } }
@media (min-width:1024px){ #videos { grid-template-columns:repeat(4,1fr); } }

.video-card { background:#1e293b; border-radius:12px; overflow:hidden; position:relative; cursor:pointer; transition:0.3s; }
.video-card img { width:100%; display:block; }
.video-card .overlay {
  position:absolute; bottom:0; left:0; width:100%; background:rgba(0,0,0,0.6); color:#fff; padding:8px; opacity:0; transition:0.3s;
}
.video-card:hover .overlay { opacity:1; }

/* ========== Pagination ========== */
.pagination { display:flex; justify-content:center; gap:10px; margin:20px 0; }
.pagination button { padding:8px 14px; border:none; border-radius:6px; background:#2563eb; color:#fff; cursor:pointer; }

/* ========== Footer ========== */
footer { text-align:center; padding:15px; background:#0f172a; color:#fff; margin-top:20px; font-size:0.9rem; }

/* ========== Animations ========== */
@keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
</style>
</head>
<body>

<!-- 18+ Popup -->
<div id="agePopup" class="active">
  <div>
    <p>Apakah umur Anda 18+?</p>
    <button id="yes">Ya</button>
    <button id="no">Tidak</button>
  </div>
</div>

<!-- Header -->
<header>
  <div class="logo">Narapoi</div>
  <input type="text" id="search" placeholder="Cari video...">
</header>

<!-- Popular -->
<section id="popular">
  <button class="nav prev">&#10094;</button>
  <div class="track"></div>
  <button class="nav next">&#10095;</button>
</section>

<!-- Videos Grid -->
<section id="videos"></section>

<!-- Pagination -->
<div class="pagination">
  <button id="prev">Prev</button>
  <button id="next">Next</button>
</div>

<footer>Narapoi</footer>

<script>
const API = "https://asupan.aku679093.workers.dev/api/videos";
let videos = [];
let currentPage = 1;
const perPage = 10;

// ========== 18+ Popup ==========
const agePopup = document.getElementById("agePopup");
document.getElementById("yes").onclick = () => { agePopup.classList.remove("active"); }
document.getElementById("no").onclick = () => { alert("Anda harus berumur 18+ untuk masuk"); }

// ========== Fetch Videos ==========
async function fetchVideos(){
  const res = await fetch(API);
  videos = await res.json();
  renderPopular();
  renderGrid();
}

// ========== Popular Carousel ==========
const track = document.querySelector("#popular .track");
function renderPopular(){
  const popular = [...videos].sort((a,b)=>b.views-a.views).slice(0,5);
  track.innerHTML = popular.map(v=>`
    <div class="item">
      <img src="${v.thumbnail}" alt="${v.title}">
      <div class="overlay">${v.title}<br>${v.genre}</div>
    </div>
  `).join('');
}

let scrollIndex = 0;
document.querySelector("#popular .next").onclick = () => {
  if(scrollIndex < track.children.length-1){ scrollIndex++; track.style.transform=`translateX(-${scrollIndex*215}px)`; }
}
document.querySelector("#popular .prev").onclick = () => {
  if(scrollIndex>0){ scrollIndex--; track.style.transform=`translateX(-${scrollIndex*215}px)`; }
}

// ========== Grid Videos ==========
const grid = document.getElementById("videos");
function renderGrid(){
  const start = (currentPage-1)*perPage;
  const pageVideos = videos.slice(start,start+perPage);
  grid.innerHTML = pageVideos.map(v=>`
    <div class="video-card">
      <img src="${v.thumbnail}" alt="${v.title}">
      <div class="overlay">${v.title}<br>${v.genre}</div>
    </div>
  `).join('');
}

// ========== Pagination ==========
document.getElementById("prev").onclick = () => { if(currentPage>1){ currentPage--; renderGrid(); } }
document.getElementById("next").onclick = () => { if(currentPage<Math.ceil(videos.length/perPage)){ currentPage++; renderGrid(); } }

// ========== Search ==========
document.getElementById("search").addEventListener("input",(e)=>{
  const val = e.target.value.toLowerCase();
  const filtered = videos.filter(v=>v.title.toLowerCase().includes(val));
  grid.innerHTML = filtered.slice(0,perPage).map(v=>`
    <div class="video-card">
      <img src="${v.thumbnail}" alt="${v.title}">
      <div class="overlay">${v.title}<br>${v.genre}</div>
    </div>
  `).join('');
});

fetchVideos();
</script>

</body>
</html>
