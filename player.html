<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Player - Narapoi</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family: 'Segoe UI', system-ui, sans-serif;
    background: #0f172a;
    color: #fff;
    line-height: 1.5;
  }
  a { text-decoration: none; color: inherit; }

  /* Header */
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background: #111827;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }
  .logo { font-size: 1.9rem; font-weight: bold; color: #ec4899; }

  .search input {
    padding: 10px 14px;
    border-radius: 8px;
    border: none;
    background: #1f2937;
    color: white;
    width: 100%;
    max-width: 280px;
    font-size: 15px;
  }
  .search input::placeholder { color: #94a3b8; }

  /* Player */
  .player-container { padding: 15px 20px; }
  video {
    width: 100%;
    aspect-ratio: 16/9;
    border-radius: 12px;
    background: #000;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  }

  /* Video Info */
  .video-info {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    font-size: 14px;
    color: #cbd5e1;
  }

  /* Tombol Kembali */
  #backBtn {
    display: inline-block;
    margin: 12px 0;
    padding: 8px 16px;
    border: none;
    border-radius: 8px;
    background: #ef4444;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }
  #backBtn:hover { background: #f87171; transform: translateY(-2px); }

  /* Download Area */
  #downloadContainer {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
  }

  #tutorial {
    font-weight: 600;
    font-size: 15px;
    color: #e5e7eb;
    text-align: center;
    min-height: 80px;
    white-space: pre-wrap;
    line-height: 1.5;
    opacity: 0;
    transform: translateY(15px);
    animation: fadeInUp 0.8s forwards 0.4s;
  }

  #downloadBtn {
    padding: 14px 24px;
    width: 100%;
    max-width: 340px;
    border: none;
    border-radius: 10px;
    background: linear-gradient(135deg, #2563eb, #3b82f6);
    color: white;
    font-size: 17px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 6px 20px rgba(37,99,235,0.4);
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.7s forwards 0.6s;
  }
  #downloadBtn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(37,99,235,0.6);
    background: linear-gradient(135deg, #3b82f6, #60a5fa);
  }

  /* Social Buttons */
  .social-btns {
    display: flex;
    justify-content: center;
    gap: 18px;
    margin-top: 12px;
  }
  .social-btns button {
    width: 48px;
    height: 48px;
    border: none;
    border-radius: 12px;
    background: #1f2937;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s;
  }
  .social-btns button:hover {
    background: #2563eb;
    transform: scale(1.1);
  }
  .social-btns img, .social-btns svg {
    width: 24px;
    height: 24px;
    filter: brightness(0) invert(1);
  }

  /* Related Videos */
  #related {
    display: grid;
    gap: 16px;
    margin: 30px 20px;
    grid-template-columns: repeat(2, 1fr);
  }
  @media (min-width: 768px) { #related { grid-template-columns: repeat(3, 1fr); } }
  @media (min-width: 1024px) { #related { grid-template-columns: repeat(4, 1fr); } }

  .grid-item {
    border-radius: 10px;
    overflow: hidden;
    transition: all 0.3s;
    cursor: pointer;
    background: #1e293b;
  }
  .grid-item:hover { transform: translateY(-6px); box-shadow: 0 12px 30px rgba(0,0,0,0.4); }
  .grid-item img {
    width: 100%;
    aspect-ratio: 16/9;
    object-fit: cover;
    display: block;
  }
  .grid-item .info {
    padding: 10px;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.4s;
  }
  .grid-item:hover .info { opacity: 1; transform: translateY(0); }
  .grid-item .title { font-weight: 600; margin-bottom: 4px; font-size: 14px; }
  .grid-item .genre { color: #94a3b8; font-size: 13px; }

  /* Footer */
  footer {
    text-align: center;
    padding: 20px;
    background: #111827;
    color: #9ca3af;
    font-size: 0.9rem;
    margin-top: 30px;
  }

  /* Animasi */
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
  }
</style>
</head>
<body>

<header>
  <div class="logo">Narapoi</div>
  <div class="search">
    <input type="text" id="search" placeholder="Cari video...">
  </div>
</header>

<div class="player-container">
  <video id="mainVideo" controls>
    <source id="videoSrc" src="" type="video/mp4">
    Browsermu tidak mendukung video.
  </video>

  <div class="video-info">
    <div>Genre: <span id="videoGenre"></span></div>
    <div>Views: <span id="videoViews">12345</span> | Online: <span id="videoOnline">67</span></div>
  </div>

  <button id="backBtn">‚Üê Kembali</button>

  <div id="downloadContainer">
    <div id="tutorial"></div>

    <button id="downloadBtn">UNDUH FULL PACK</button>

    <div class="social-btns">
      <button id="waBtn">
        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WA">
      </button>
      <button id="ytBtn">
        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/youtube.svg" alt="YT">
      </button>
      <button id="copyBtn">
        <!-- SVG Rantai / Link -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M10 13a5 5 0 0 0 7.546.666L17 14l1.293-1.293a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0L14 11"/>
          <path d="M14 11l-3.586 3.586a2 2 0 0 1-2.828 0l-1.414-1.414a2 2 0 0 1 0-2.828L9 9"/>
          <path d="M6 6l12 12"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<div id="related"></div>

<footer>Narapoi ¬© 2026</footer>

<script>
const API = "https://asupan.aku679093.workers.dev/api/videos";
const urlParams = new URLSearchParams(window.location.search);
const videoId = urlParams.get('id');
let videosData = [];

// Back Button
document.getElementById('backBtn').onclick = () => window.history.back();

// Load Video & Data
async function loadVideo() {
  try {
    const res = await fetch(API);
    videosData = await res.json();
    const video = videosData.find(v => v.id === videoId) || videosData[0];
    if (!video) return;

    document.getElementById('videoSrc').src = video.video_url;
    document.getElementById('mainVideo').load();
    document.getElementById('videoGenre').innerText = video.genre || "Uncategorized";

    // Tutorial dengan typing animation
    const tutorialEl = document.getElementById('tutorial');
    const text = "TUTORIAL DOWNLOAD:\n1. Klik tombol 'UNDUH FULL PACK'\n2. Tunggu & lewati iklan/redirect\n3. Video akan otomatis siap diunduh setelah iklan selesai";
    tutorialEl.innerHTML = '';
    typeWriter(tutorialEl, text, 0);
  } catch (err) {
    console.error("Gagal load video:", err);
  }
}

// Typing Animation lebih halus
function typeWriter(el, text, i) {
  if (i < text.length) {
    if (text.charAt(i) === '\n') {
      el.innerHTML += '<br>';
    } else {
      el.innerHTML += text.charAt(i);
    }
    i++;
    setTimeout(() => typeWriter(el, text, i), 35);
  }
}

// Download Button (contoh redirect + delay)
document.getElementById('downloadBtn').onclick = () => {
  const video = videosData.find(v => v.id === videoId) || videosData[0];
  if (!video) return alert("Video tidak ditemukan");

  const adLink = "https://rm.riskilychous.com/iKZtvVhhVWc/131416";
  window.location.href = adLink;
  // Opsional: bisa tambah setTimeout jika ingin auto ke final link
  // setTimeout(() => { window.location.href = video.video_url; }, 1500);
};

// Copy Link
document.getElementById('copyBtn').onclick = () => {
  navigator.clipboard.writeText(window.location.href)
    .then(() => alert("Link berhasil disalin! üìé"))
    .catch(() => alert("Gagal menyalin link"));
};

// WA & YT (ganti # dengan link asli kalau ada)
document.getElementById('waBtn').onclick = () => window.open("https://wa.me/628xxxx", "_blank");
document.getElementById('ytBtn').onclick = () => window.open("https://youtube.com/@narapoi", "_blank");

// Related Videos
function renderRelated() {
  const shuffled = [...videosData].sort(() => Math.random() - 0.5).slice(0, 10);
  document.getElementById('related').innerHTML = shuffled.map(v => `
    <div class="grid-item" onclick="window.location.href='player.html?id=${v.id}'">
      <img src="\( {v.thumbnail || 'https://via.placeholder.com/320x180?text=Thumbnail'}" alt=" \){v.title}">
      <div class="info">
        <div class="title">${v.title || "Video Tanpa Judul"}</div>
        <div class="genre">${v.genre || "Lainnya"}</div>
      </div>
    </div>
  `).join('');
}

// Search
document.getElementById('search').addEventListener('input', e => {
  const q = e.target.value.toLowerCase().trim();
  if (!q) {
    renderRelated();
    return;
  }
  const filtered = videosData.filter(v => v.title?.toLowerCase().includes(q));
  document.getElementById('related').innerHTML = filtered.map(v => `
    <div class="grid-item" onclick="window.location.href='player.html?id=${v.id}'">
      <img src="\( {v.thumbnail || 'https://via.placeholder.com/320x180?text=Thumbnail'}" alt=" \){v.title}">
      <div class="info">
        <div class="title">${v.title || "Video Tanpa Judul"}</div>
        <div class="genre">${v.genre || "Lainnya"}</div>
      </div>
    </div>
  `).join('');
});

// Init
loadVideo();
renderRelated();
</script>
</body>
</html>
