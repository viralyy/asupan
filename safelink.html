<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Safelink Generator</title>

<style>
:root{
  --bg:#05060f;
  --card:#0b1020;
  --accent:#3b82f6;
  --muted:#94a3b8;
  --border:#1e293b;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:radial-gradient(80% 80% at 50% 0%,#0b1020,#05060f);
  font-family:system-ui,Segoe UI,Arial;
  color:#fff;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card{
  width:100%;
  max-width:460px;
  background:rgba(11,16,32,.9);
  backdrop-filter:blur(14px);
  padding:28px;
  border-radius:22px;
  box-shadow:0 25px 50px rgba(0,0,0,.45);
}
h1{
  margin:0 0 6px;
  font-size:24px;
}
p{
  margin:0 0 18px;
  color:var(--muted);
  font-size:14px;
}
input{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:1px solid var(--border);
  background:#020617;
  color:#fff;
  font-size:15px;
  outline:none;
}
input:focus{border-color:var(--accent)}
button{
  margin-top:14px;
  width:100%;
  padding:14px;
  border:0;
  border-radius:14px;
  background:linear-gradient(135deg,#2563eb,#3b82f6);
  color:#fff;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}
.result{
  margin-top:18px;
  padding-top:16px;
  border-top:1px dashed var(--border);
  display:none;
}
.row{
  display:flex;
  gap:10px;
  margin-top:10px;
}
.row button{
  margin:0;
  flex:1;
  background:#020617;
  border:1px solid var(--border);
}
small{
  color:var(--muted);
  font-size:13px;
}
.qr{
  margin-top:14px;
  display:flex;
  justify-content:center;
}
footer{
  margin-top:14px;
  text-align:center;
  font-size:12px;
  color:#64748b;
}
</style>
</head>
<body>

<div class="card">
  <h1>Safelink Generator</h1>
  <p>Pendekin & amankan link tanpa backend</p>

  <input id="url" placeholder="https://example.com">
  <input id="alias" placeholder="Alias (opsional)">

  <button onclick="generate()">Generate Safelink</button>

  <div class="result" id="result">
    <small>Safelink</small>
    <input id="out" readonly>

    <div class="row">
      <button onclick="copy()">üìã Copy</button>
      <button onclick="openLink()">üöÄ Open</button>
    </div>

    <small style="margin-top:12px;display:block">Preview tujuan</small>
    <input id="preview" readonly>

    <div class="qr">
      <canvas id="qr"></canvas>
    </div>
  </div>

  <footer>
    Powered by Safelink
  </footer>
</div>

<script>
function b64urlEncode(str){
  // base64url: tanpa '=', '+' jadi '-', '/' jadi '_'
  return btoa(unescape(encodeURIComponent(str)))
    .replace(/=/g,"")
    .replace(/\+/g,"-")
    .replace(/\//g,"_");
}

function generate(){
  const v=document.getElementById("url").value.trim();
  if(!v.startsWith("http")){
    alert("URL tidak valid");
    return;
  }

  const a=document.getElementById("alias").value.trim();
  const enc=b64urlEncode(v);

  // lebih pendek: "?=" –≤–º–µ—Å—Ç–æ "?r="
  let link=location.origin+"/views.html?="+enc;

  // alias opsional (tetap tanpa backend, cuma nempel di link)
  if(a){
    link += "&a=" + encodeURIComponent(a);
  }

  document.getElementById("out").value=link;
  document.getElementById("preview").value=v;
  document.getElementById("result").style.display="block";

  qr(link);
}

function copy(){
  navigator.clipboard.writeText(
    document.getElementById("out").value
  );
  alert("Safelink disalin!");
}

function openLink(){
  window.open(document.getElementById("out").value,"_blank");
}

/* simple QR */
function qr(text){
  const c=document.getElementById("qr");
  const s=160;
  c.width=c.height=s;
  const ctx=c.getContext("2d");
  ctx.fillStyle="#fff";
  ctx.fillRect(0,0,s,s);
  ctx.fillStyle="#000";
  let i=0;
  for(let y=0;y<20;y++){
    for(let x=0;x<20;x++){
      if((text.charCodeAt(i%text.length)+x+y)%2){
        ctx.fillRect(x*8,y*8,8,8);
      }
      i++;
    }
  }
}
</script>

</body>
</html>
